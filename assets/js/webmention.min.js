// @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&dn=expat.txt
!function(){"use strict";window.i18next=window.i18next||{t:function t(e){return e}};let t=window.i18next.t.bind(window.i18next);function e(t,e){return document.currentScript.getAttribute("data-"+t)||e}let n=e("page-url",window.location.href.replace(/#.*$/,"")),o=e("add-urls",void 0),r=e("id","webmentions"),l=e("wordcount"),i=e("max-webmentions",30),s=e("prevent-spoofing")?"wm-source":"url",a=e("sort-by","published"),c=e("sort-dir","up"),u=e("comments-are-reactions"),p={"in-reply-to":t("replied"),"like-of":t("liked"),"repost-of":t("reposted"),"bookmark-of":t("bookmarked"),"mention-of":t("mentioned"),rsvp:t("RSVPed"),"follow-of":t("followed")},f={yes:"✅",no:"❌",interested:"\uD83D\uDCA1",maybe:"\uD83D\uDCAD"};function d(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function h(e,n){let o=d(e.author?.name||e.url.split("/")[2]),r=p[e["wm-property"]]||t("reacted");!n&&e.content&&e.content.text&&(r+=": "+v(e));let l="";e.author&&e.author.photo&&(l=`
        <img
          src="${d(e.author.photo)}"
          loading="lazy"
          decoding="async"
          alt="${o}"
        >
      `);let i="";return e.rsvp&&f[e.rsvp]&&(i=`<sub>${f[e.rsvp]}</sub>`),`
      <div class="row">
        <div class="col-2">
          <a  class="reaction" rel="nofollow ugc" title="${o} ${r}" href="${e[s]}">
            ${l} 
          </a>
        </div>     
        <div class="col-10">
          <div>${source}</div>
          <div>${i}</div>
        </div>     
      </div>     
    `}function m(t){return t.substr(t.indexOf("//"))}function g(t){let e=[],n={};return t.forEach(function(t){let o=m(t.url);n[o]||(e.push(t),n[o]=!0)}),e}function v(t){let e=d(t.content.text);if(l){let n=e.replace(/\s+/g," ").split(" ",l+1);n.length>l&&(n[l-1]+="&hellip;",e=(n=n.slice(0,l)).join(" "))}return e}window.addEventListener("load",async function(){let e=document.getElementById(r);if(!e)return;let l=[m(n)];o&&o.split("|").forEach(function(t){l.push(m(t))});let p=`https://webmention.io/api/mentions.jf2?per-page=${i}&sort-by=${a}&sort-dir=${c}`;l.forEach(function(t){p+=`&target[]=${encodeURIComponent("http:"+t)}&target[]=${encodeURIComponent("https:"+t)}`});let f={};try{let b=await window.fetch(p);b.status>=200&&b.status<300?f=await b.json():(console.error("Could not parse response"),Error(b.statusText))}catch(w){console.error("Request failed",w)}let y=[],$=[];u&&(y=$);let x={"in-reply-to":y,"like-of":$,"repost-of":$,"bookmark-of":$,"follow-of":$,"mention-of":y,rsvp:y};f.children.forEach(function(t){let e=x[t["wm-property"]];e&&e.push(t)});let k="";y.length>0&&y!==$&&(k=function e(n){let o=`<h2>${t("Responses")}</h2>`,r=n.map(e=>{let n=h(e,!0),o=d(e.url.split("/")[2]);e.author&&e.author.name&&(o=d(e.author.name));let r=`<a class="source" rel="nofollow ugc" href="${e[s]}">${o}</a>`,l="name",i=`(${t("mention")})`;e.name?(l="name",i=e.name):e.content&&e.content.text&&(l="text",i=v(e));let a=`<span class="${l}">${i}</span>`;return`<li>${n} ${r} ${a}</li>`}).join("");return`
      ${o}
      <ul class="comments">${r}</ul>
    `}(g(y)));let _="";$.length>0&&(_=function e(n){let o=`<h2>${t("Reactions")}</h2>`,r=n.map(t=>h(t)).join("");return`
      ${o}
      <ul class="reacts">${r}</ul>
    `}(g($))),e.innerHTML=`${k}${_}`})}(); // @license-end